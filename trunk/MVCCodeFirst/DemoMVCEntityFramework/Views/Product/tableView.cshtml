@model PagedList.IPagedList<DemoMVCEntityFramework.Models.Product>
@using PagedList.Mvc;

<link href="~/Content/PagedList.css" rel="stylesheet" />
<script type="text/javascript">
    function filter(phrase, _id) {
        var words = phrase.value.toLowerCase().split(" ");
        var table = document.getElementById(_id);
        var ele;
        for (var r = 1; r < table.rows.length; r++) {
            ele = table.rows[r].innerHTML.replace(/<[^>]+>/g, "");
            var displayStyle = 'none';
            for (var i = 0; i < words.length; i++) {
                if (ele.toLowerCase().indexOf(words[i]) >= 0)
                    displayStyle = '';
                else {
                    displayStyle = 'none';
                    break;
                }
            }
            table.rows[r].style.display = displayStyle;
        }
    }
</script>
<form>
    <input name="filt" onkeyup="filter(this, 'tbproduct', '1')" type="text">
</form>
<table class="tbproduct" id="tbproduct" data-role="table" border="0" cellpadding="10" cellspacing="5">
    <thead>
    <th style="display:none"></th>
    <th>Product</th>
    <th>Category</th>
    <th>Quantity</th>
    <th>Price</th>
    <th>InStock</th>
    <th>OnOrder</th>
    <th>ReorderLevel</th>
    <th>Discontinued</th>
    </thead>
    @foreach (var item in Model)
    {
        <tr id="item_@item.ProductID">
            <td style="display:none">
                @Html.HiddenFor(modelItem => item.ProductID)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.ProductName)
            </td>
            <td align="center">
                @Html.DisplayFor(modelItem => item.Category.CategoryName)
            </td>
            <td align="center">
                @Html.DisplayFor(modelItem => item.QuantityPerUnit)
            </td>
            <td align="center">
                @Html.DisplayFor(modelItem => item.UnitPrice)
            </td>
            <td align="center">
                @Html.DisplayFor(modelItem => item.UnitsInStock)
            </td>
            <td align="center">
                @Html.DisplayFor(modelItem => item.UnitsOnOrder)
            </td>
            <td align="center">
                @Html.DisplayFor(modelItem => item.ReorderLevel)
            </td>
            <td align="center">
                @Html.DisplayFor(modelItem => item.Discontinued)
            </td>
        </tr>
    }
</table>

<br />

Page @(Model.PageCount < Model.PageNumber ? 0 : Model.PageNumber) of @Model.PageCount
@Html.PagedListPager(Model, page => Url.Action("Index", new { page, categoryID = ViewBag.SelectedCategoryID}))
<script type="text/javascript">
    $(document).ready(function () {
        $(".tbproduct tbody tr   ").mouseover(function () {
            $this = $(this);
            $(".tbproduct tbody tr   ").removeClass("_selected");
            $this.addClass("_selected");
        });

        $(".tbproduct tbody tr   ").mouseout(function () {
            $this = $(this);
            $(".tbproduct tbody tr   ").removeClass("_selected");
        });
        $(".tbproduct tbody tr   ").dblclick(function () {
            $this = $(this);
            if ($this.length > 0) {
                var jobNum = $this.find("#item_ProductID").val();
                //alert(jobNum);
                $.ajax({
                    type: "GET",
                    url: "http://localhost:5325/Product/Details?id=" + jobNum,
                    data: jobNum,
                    contentType: "text/xml; charset=utf-8",
                    success: function (data) {
                        $('#tblpro').html(data);
                    },
                    error: function (error) {
                        alert(error.state + " " + error.statusText)
                    }
                });
                document.getElementById("dialogform").showModal();
                //window.open('http://localhost:5325/Product/Details?id=' + jobNum, '_self', false);

            }
        });
        $("#dialogform").dblclick(function () {
            document.getElementById("dialogform").close();
        });
        //function filter(term, _id, cellNr) {
        //    var suche = term.value.toLowerCase();
        //    var table = document.getElementById(_id);
        //    var ele;
        //    for (var r = 1; r < table.rows.length; r++) {
        //        ele = table.rows[r].cells[cellNr].innerHTML.replace(/<[^>]+>/g, "");
        //        if (ele.toLowerCase().indexOf(suche) >= 0)
        //            table.rows[r].style.display = '';
        //        else table.rows[r].style.display = 'none';
        //    }
        //}
        //function filter (phrase, _id)
        //{
        //    var words = phrase.value.toLowerCase().split(" ");
        //    var table = document.getElementById(_id);
        //    var ele;
        //    for (var r = 1; r < table.rows.length; r++) {
        //        ele = table.rows[r].innerHTML.replace(/<[^>]+>/g, "");
        //        var displayStyle = 'none';
        //        for (var i = 0; i < words.length; i++) {
        //            if (ele.toLowerCase().indexOf(words[i]) >= 0)
        //                displayStyle = '';
        //            else {
        //                displayStyle = 'none';
        //                break;
        //            }
        //        }
        //        table.rows[r].style.display = displayStyle;
        //    }
        //};
   });
</script>